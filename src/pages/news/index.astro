---
import Layout from "../../layouts/Layout.astro";
import { getBlogs } from "../../lib/microcms";

// Fetch all blogs
const { contents: blogs } = await getBlogs();
---

<Layout title="News & Updates | Roborave Mie">
    <div class="pt-32 pb-20 bg-gray-50 min-h-screen">
        <div class="max-w-screen-xl mx-auto px-4">
            <!-- Page Header -->
            <div class="text-center mb-16">
                <h1 class="text-4xl md:text-5xl font-bold text-slate-900 mb-4">
                    News & Updates
                </h1>
                <p class="text-slate-600 text-lg max-w-2xl mx-auto">
                    Stay up to date with the latest announcements, competition
                    results, and behind-the-scenes stories.
                </p>
            </div>

            <!-- Blog Grid -->
            {
                blogs.length === 0 ? (
                    <div class="text-center py-20">
                        <div class="text-6xl mb-4">ðŸ“­</div>
                        <p class="text-xl text-gray-500">
                            No news articles found.
                        </p>
                    </div>
                ) : (
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        {blogs.map((blog) => (
                            <a
                                href={`/blog/${blog.id}`}
                                class="group group-hover:no-underline"
                            >
                                <article class="bg-white rounded-2xl overflow-hidden shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100 h-full flex flex-col hover:-translate-y-1">
                                    <div class="relative overflow-hidden aspect-video bg-gray-100">
                                        {blog.thumbnail ? (
                                            <img
                                                src={blog.thumbnail.url}
                                                alt={blog.title}
                                                class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                                            />
                                        ) : (
                                            <div class="w-full h-full flex items-center justify-center bg-blue-50 text-blue-200">
                                                <span class="text-4xl">ðŸ“°</span>
                                            </div>
                                        )}
                                    </div>
                                    <div class="p-6 flex flex-col flex-grow">
                                        <div class="flex items-center text-gray-400 text-sm mb-3">
                                            <time datetime={blog.publishedAt}>
                                                {new Date(
                                                    blog.publishedAt,
                                                ).toLocaleDateString("ja-JP", {
                                                    year: "numeric",
                                                    month: "long",
                                                    day: "numeric",
                                                })}
                                            </time>
                                        </div>
                                        <h4 class="text-xl font-bold text-slate-900 mb-3 group-hover:text-blue-600 transition-colors line-clamp-2">
                                            {blog.title}
                                        </h4>
                                        <p class="text-gray-600 line-clamp-3 text-sm flex-grow">
                                            {blog.content
                                                .replace(/<[^>]*>/g, "")
                                                .substring(0, 100)}
                                            ...
                                        </p>
                                        <div class="mt-4 flex items-center text-blue-600 font-bold text-sm">
                                            Read More
                                            <svg
                                                class="w-4 h-4 ml-2 transition-transform group-hover:translate-x-1"
                                                fill="none"
                                                stroke="currentColor"
                                                viewBox="0 0 24 24"
                                            >
                                                <path
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    stroke-width="2"
                                                    d="M14 5l7 7m0 0l-7 7m7-7H3"
                                                />
                                            </svg>
                                        </div>
                                    </div>
                                </article>
                            </a>
                        ))}
                    </div>
                )
            }
        </div>
    </div>
</Layout>
